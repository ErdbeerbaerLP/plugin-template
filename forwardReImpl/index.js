(function(o,r,c,n){"use strict";const t="ForwardReImplementation";function m(s,g){let e={id:"",type:0,content:"",channel_id:g.id,author:{id:"",username:"",avatar:"",discriminator:"",publicFlags:0,avatarDecoration:null},attachments:[],embeds:[],mentions:[],mention_roles:[],pinned:!1,mention_everyone:!1,tts:!1,timestamp:"",edited_timestamp:null,flags:0,components:[]};return typeof s=="string"?e.content=s:e={...e,...s},e}let i=[];const d=function(){try{const s=c.before("dispatch",r.FluxDispatcher,function(g){let[e]=g;e.type==="LOAD_MESSAGES_SUCCESS"&&e.messages.forEach(function(a){Array.isArray(a.message_snapshots)&&a.message_snapshots.length&&(Object.assign(a,a.message_snapshots[0].message),delete a.message_snapshots,a.content=a.content+`
*(Forwarded from 
https://discord.com/channels/`+a.message_reference.guild_id+"/"+a.message_reference.channel_id+"/"+a.message_reference.message_id+")*")}),(e.type==="MESSAGE_CREATE"||e.type==="MESSAGE_UPDATE")&&Array.isArray(e.message.message_snapshots)&&e.message.message_snapshots.length&&(Object.assign(e.message,e.message.message_snapshots[0].message),delete e.message.message_snapshots,e.message.content=e.message.content+`
*(Forwarded from 
https://discord.com/channels/`+e.message.message_reference.guild_id+"/"+e.message.message_reference.channel_id+"/"+e.message.message_reference.message_id+")*")});return i.push(s),n.logger.log(`${t} loaded.`),null}catch(s){n.logger.log(`[${t} Error]`,s)}},l=function(){n.logger.log(`Loading ${t}...`);for(let s of["MESSAGE_CREATE","MESSAGE_UPDATE"])n.logger.log(`Dispatching ${s} to enable action handler.`),r.FluxDispatcher.dispatch({type:s,message:m("PLACEHOLDER",{id:"0"})});for(let s of["LOAD_MESSAGES","LOAD_MESSAGES_SUCCESS"])n.logger.log(`Dispatching ${s} to enable action handler.`),r.FluxDispatcher.dispatch({type:s,messages:[]});d()};l();var h={onLoad:l,onUnload:function(){n.logger.log(`Unloading ${t}...`);for(let s of i)s();n.logger.log(`${t} unloaded.`)}};return o.default=h,Object.defineProperty(o,"__esModule",{value:!0}),o})({},vendetta.metro.common,vendetta.patcher,vendetta);
